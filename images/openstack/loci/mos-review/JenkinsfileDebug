import com.att.nccicd.config.conf as config
import groovy.json.JsonSlurperClassic

conf = new config(env).CONF
RETRY_COUNT = RETRY_COUNT.toInteger()

projectList = new JsonSlurperClassic().parseText(PROJECT_LIST)

if (GERRIT_BRANCH == conf.OCATA_BRANCH) {
    RELEASE = 'ocata'
} else if (GERRIT_BRANCH == conf.STEIN_BRANCH) {
    RELEASE = 'stein'
} else {
    error("Unsupported branch: ${GERRIT_BRANCH}")
}


utils.runBuild(
    "${JOB_BASE}/DebugDeploymentPipeline",
    [stringParam(name: 'RELEASE', value: RELEASE)],
    RETRY_COUNT,
)
